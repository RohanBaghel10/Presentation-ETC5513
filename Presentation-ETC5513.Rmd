---
title: "Xaringan Template"
subtitle: "An example"
author: "Patricia Menéndez"
institute: "Department of Econometrics and Business Statistics"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: css/style.css
    yolo: FALSE
---


```{r setup, include=FALSE, echo=FALSE}
options(htmltools.dir.version = FALSE)
```



```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(readr)
La_liga_data <- read.csv("data/laliga_player_stats_english.csv")
```


class: left, middle
# Defender position 


```{r out.width = '50%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/position.png")
```

* In the sport of association football, a defender is an outfield player whose primary roles are to stop attacks during the game and prevent the opposing team from scoring goals.

* Center backs are usually in pairs, with two full-backs to their left and right, but can come in threes with no full backs.

---
class: left, middle

Two main important characteristics of a defender :
.content-box-soft[
* **Recovery**  - A recovery is recorded at the point where the player of the team beginning the possession touches the ball. 
]
.content-box-soft[
* **Clearance** - When a player kicks the ball away from the goal they are defending. 
]
.content-box-soft[
We will only analyze players who have played more than **50%** of the games, considering consistency is key factor for a 38 matches long league.
]


```{r out.width = '20%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/logo.png")
```


---
class: left, middle
# Clearance Vs Recovery

* We will be analyzing the data to get the best defender by going through some levels.
* The first and major one being, plotting **Clearance Vs Recoveries** as the these are the two most important characteristics of a defender.


```{r out.width = '70%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/CvsR.png")
```


---
class: left, middle
# Pique Vs Laguardia

* **Pique and Laguardia** came out on top in the first level as they had the most impact as a defender.
* Now we will try to choose the best defender by bringing in more variables into the picture. 


```{r out.width = '70%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/PvsL.png")
```


---
class: left, middle
# Who has made more mistakes?

* Now we will be judging the players on the number of mistakes made by them as they are giving each other a tough competition.

```{r out.width = '70%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/worse.png")
```

* As we can clearly see Laguardia has made significantly more mistakes while on the pitch, **Pique** is defender who wins this competetion.

* On top of of that pique has also scored 4 goals for .blue[FC] .red[BARCELONA]

---

class: center, middle
# The Midfielder

```{r echo=FALSE, out.width = '100%', fig.align='center'}
knitr::include_graphics("figs/Midfielder-image.jpg")
```

Image Source : Getty Images 

---
class:left, top 
# Role 

* Act as link between the **Strikers** and the **Defenders**. 

* Control the flow of the game.

* Effective communicator 

```{r fig.align='center', echo=FALSE, out.width='35%', out.height== '35%'}
knitr::include_graphics("figs/mid-pos.png")
```

---

class:left, top

#Best Offensive Midfielders in La Liga

```{r echo=FALSE, out.height='80%', out.width='80%', fig.align='center'}
knitr::include_graphics("figs/Attack_M_Table.png")
```
---

class:left,top

#Best Offensive Midfielders in La Liga

```{r echo=FALSE, out.height='70%', out.width='80%', fig.align='center'}
knitr::include_graphics("figs/Attack_M_Graph.png")
```
---

class:left,top

#Best Defensive Midfielders in La Liga

```{r echo=FALSE, out.height='80%', out.width='80%', fig.align='center'}
knitr::include_graphics("figs/Defence_M_Table.png")
```
---

class:left,top

#Best Defensive Midfielders in La Liga

```{r echo=FALSE, out.height='70%', out.width='80%', fig.align='center'}
knitr::include_graphics("figs/Defence_M_Graph.png")
```
---

class:center, middle

#Best Overall performance as a Midfielder in La Liga

```{r echo=FALSE,  fig.align='center'}
knitr::include_graphics("figs/Overall_player.png")
```

---
class: center, middle

# Position: Goalkeeper
```{r out.width = '60%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/goal1.webp")
```
.blue[The goalkeeper, sometimes shortened to keeper or goalie, is one of the major positions of association football.]

.pull-left[.tiny[<span>Photo by <a href="https://laligaexpert.com/2021/09/08/la-liga-goalkeepers/">Laligaexpert</a></span>]
]

---
class: center, middle

# .bold[Aim:  Best Goalkeeper ]

```{r out.width = '60%', echo = FALSE, fig.align="center"}
knitr::include_graphics("figs/goal2.png")
```
- .green[Which goalkeeper has the best performance in La-Liga during the season 2019 - 2020?]

---
class: left, middle
# Terms
## “Recoveries” 
.content-box-soft[
- Recovering the ball in a situation where neither team has possession or where the ball has been played directly to a player by an opponent.
]

## “Clearances” 
.content-box-soft[
- When a goalkeeper kicks the ball away from the goal they are defending
]

---
class: center, middle

### Goalkeeper

```{r echo = FALSE, message = FALSE, warning = FALSE}
goal_data <- La_liga_data %>%
  filter(Position == "Goalkeeper") %>%
  select(Team, Position, Name, Games.played, Goals.conceded.while.player.on.pitch, Recoveries, Clearances) %>%
  rename("Game_played" = Games.played,
         "Goal_conceded" = Goals.conceded.while.player.on.pitch)
mean_goal_data <- goal_data %>%
  filter(Game_played > 0)
```

```{r graph-data, out.width = '65%', echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Recoveries and Clearances", fig.align='center'}
p2 <- ggplot(mean_goal_data, 
             aes(x = Name, 
                 y = Recoveries, label = Name)) +
  geom_point() +
  geom_text(hjust = 0.5, vjust = -1) + 
  theme(axis.text.x=element_blank(),
        axis.ticks = element_blank())

p3 <- ggplot(mean_goal_data, 
             aes(x = Name, 
                 y = Clearances, label = Name)) +
  geom_point() +
  geom_text(hjust = 0.5, vjust = -1) + 
  theme(axis.text.x=element_blank(),
        axis.ticks = element_blank())

gridExtra::grid.arrange(p2, p3, ncol = 2)
```

---
class: center, middle
## Scatter Plot for Recoveries and Clearances
```{r scatter-plot, out.width = '60%', echo = FALSE, message = FALSE, warning = FALSE, fig.align='center'}
ggplot(goal_data, 
       aes(x = Recoveries,
           y = Clearances)) +
  geom_point() +
  theme_bw()
```

.content-box-soft[.blue[ 
- The scatter plot demonstrates a positive relationship.
]]

---
class: center, middle
### Top 10 Goalkeepers
```{r goal-data1, out.width = '50%', echo = FALSE, message = FALSE, warning = FALSE}
goal_data2 <- goal_data %>%
  select(Team, Name, Recoveries) %>%
  arrange(desc(Recoveries)) %>%
  mutate("Rank_recoveries" = 1:n())

goal_data3 <- goal_data %>%
  select(Name, Clearances) %>%
  arrange(desc(Clearances)) %>%
  mutate("Rank_clearances" = 1:n())

goal_data4 <- goal_data2 %>%
  left_join(goal_data3, by = "Name") %>%
  mutate("Average" = (Rank_recoveries + Rank_clearances)/2) %>%
  arrange(Average) %>%
  head(10) %>%
  select(Team, Name, Recoveries, Clearances) %>%
  mutate("Rank" = 1:n())

knitr::kable(goal_data4, "pipe", align = "llccr")
```


